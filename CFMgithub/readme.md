Code is borrowed from https://github.com/dreamflake/CFM.
